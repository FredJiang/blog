---
title: mysql 外键操作
date: 2016-05-24 21:23:27
tags: [mysql, key, foreign key, database, db]
---


#### 数据库

表结构

{% asset_img "schema.png" "" %}

外键

{% asset_img "foreign_key.png" "" %}

<!--more-->

#### 显示外键

`mysql> show create table student;`

```
+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table   | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                      |
+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| student | CREATE TABLE `student` (
  `name` varchar(255) DEFAULT NULL,
  `classnumber` int(11) DEFAULT NULL,
  KEY `classnumber` (`classnumber`),
  KEY `classnumber_2` (`classnumber`),
  KEY `classnumber_3` (`classnumber`),
  KEY `classnumber_4` (`classnumber`),
  KEY `classnumber_5` (`classnumber`),
  CONSTRAINT `fk_class_number` FOREIGN KEY (`classnumber`) REFERENCES `class` (`number`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 |
+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)
```

#### 锁表
如果要修改表，可以先把表锁住

`LOCK TABLES student WRITE, class WRITE;`

`其他表操作`

`UNLOCK TABLES;`

#### 删除外键


`ALTER TABLE student DROP FOREIGN KEY fk_class_number;`


#### 添加外键

`ALTER TABLE student ADD CONSTRAINT fk_class_number FOREIGN KEY (classnumber) REFERENCES class(number);`


