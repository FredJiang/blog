---
title: UNIX 网络编程 笔记 6 -- 描述符就绪
date: 2016-12-24 22:00:14
tags: [socket, unix, network, UNIX 网络编程]
---

* 套接字准备好读取
* 套接字准备好写

<!--more-->

满足下列四个条件中的任何一个时，一个套接字准备好读取。

* 该套接字接收缓冲区中的数据字节数大于等于套接字接收缓冲区低水位标记的当前大小。对这样的套接字执行读操作不会阻塞并将返回一个大于 0 的值（也就是返回准备好读入的数据）。我们可以使用 SO_RCVLOWAT 套接字 选项设置该套接字的低水位标记。对于 TCP 和 UDP 套接字而言，其默认值为 1。
* 该连接的读取半部关闭（也就是接收了 FIN 的 TCP 连接）。对这样的套接字的读取操作将不阻塞并返回 0（也就是返回 EOF）。
* 该套接字是一个监听套接字且已完成的连接数不为 0。对这样的套接字的 accept 通常不会阻塞。
* 其上有一个套接字错误待处理。对这样的套接字的读操作将不阻塞并返回 -1（也就是返回一个错误），同时把 error 设置成确切的错误条件。

下列四个条件中的任何一个满足时，一个套接字准备好写。

* 该套接字发送缓冲区中的可用空间字节数大于等于套接字发送缓冲区低水位标记的当前大小，并且或者该套接字已连接，或者该套接字不需要连接（如 UDP 套接字）。
* 该连接的写半部分关闭。对这样的套接字的写操作将产生 SIGPIPE 信号。
* 使用非阻塞式 connect 的套接字已建立连接，或者 connect 已经以失败告终。
* 其上有一个套接字错误待处理。对这样的套接字的写操作将不阻塞并返回 -1（也就是返回一个错误），同时把 errno 设置成确切的错误条件。
